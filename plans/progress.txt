## 2026-01-13 - chore-001
- Updated dependencies for SQLite migration
- Removed pg from root and server package.json
- Removed @types/pg from server devDependencies
- Added sql.js ^1.12.0 to both root and server
- Files changed: package.json, packages/server/package.json
- **Learnings:**
  - sql.js installed as 1.13.0 (latest)
  - Build/typecheck fail expected until code migration complete (chore-002+)
  - Lint errors in publish/index.js are pre-existing bundled file issues
---

## 2026-01-13 - chore-002
- Created database setup utilities for local SQLite file management
- Added ensureRalphbanDir, ensureGitignore, loadDatabase, saveDatabase functions
- Added @types/sql.js devDependency for type support
- Files changed: packages/server/src/db/setup.ts, packages/server/package.json
- **Learnings:**
  - sql.js Database can be created from Buffer for loading existing DB
  - db.export() returns Uint8Array for persistence
  - Build/test still fail due to pg imports in other files (expected until chore-003+)
---

## 2026-01-13 - chore-003
- Rewrote database client to use sql.js instead of pg Pool
- Created DbClient interface with run, exec, close methods
- Implemented auto-save mechanism that saves after every write operation (run)
- Files changed: packages/server/src/db/client.ts
- **Learnings:**
  - QueryExecResult is exported as standalone interface from sql.js, not namespaced under Database
  - createDbClient now async since loadDatabase is async
  - Build/test still fail due to pg imports in other files (expected until chore-004+)
---

## 2026-01-13 - chore-004
- Converted PostgreSQL schema to SQLite syntax in init.ts
- Replaced Pool with DbClient, JSONB with TEXT, TIMESTAMPTZ with TEXT, NOW() with CURRENT_TIMESTAMP
- Updated checkTablesExist to use sqlite_master query instead of information_schema
- Changed initializeSchema from async to sync since DbClient operations are sync
- Files changed: packages/server/src/db/init.ts
- **Learnings:**
  - SQLite uses sqlite_master table to check for table existence
  - VARCHAR(n) can be simplified to TEXT in SQLite
  - Build/test still fail due to pg imports in other files (expected until chore-005+)
---

## 2026-01-13 - chore-005
- Converted repository layer from pg Pool to sql.js DbClient
- Functions now sync instead of async
- Added TaskRow interface and rowToTask mapper for converting raw SQL results
- JSON.parse for steps field, Date conversion for timestamps
- Replaced $1/$2 params with ? placeholders, NOW() with CURRENT_TIMESTAMP
- Files changed: packages/server/src/kanban/repository.ts
- **Learnings:**
  - sql.js exec returns QueryExecResult[] with columns and values arrays
  - Need to manually map columns to row object using Object.fromEntries
  - Cast via unknown needed for dynamic object to interface conversion
  - Build/test still fail due to pg imports in other files (expected until chore-006+)
---

## 2026-01-13 - chore-006
- Updated service layers to use DbClient instead of Pool
- service.ts: made functions sync, changed Pool param to DbClient
- trpc-service.ts: added TaskRow interface, manual column-to-row mapping via exec()
- Files changed: packages/server/src/kanban/service.ts, packages/server/src/kanban/trpc-service.ts
- **Learnings:**
  - trpc-service getTasks kept async signature for IKanbanService contract compatibility
  - Reused same Object.fromEntries pattern from repository for exec() result mapping
  - Build/test still fail due to pg imports in other files (expected until chore-007+)
---
