## 2026-01-12 - chore-001
- Created packages/cli directory structure
- Added package.json with name "ralphban", bin field, private: false
- Added tsconfig.json matching server package pattern
- Created placeholder cli.ts entry point
- Updated eslint.config.js to include CLI package in node globals
- **Learnings:**
  - ESLint config at root needs explicit file patterns for new packages
  - Placeholder entry point needed for typecheck to pass on new package
---

## 2026-01-12 - chore-002
- Created packages/mcp-cli directory structure
- Added package.json with name "ralphban-mcp", bin field, private: false
- Added yargs dependency for CLI argument parsing
- Added tsconfig.json matching cli package pattern
- Created placeholder mcp-cli.ts entry point
- Updated eslint.config.js to include mcp-cli package in node globals
- **Learnings:**
  - Followed same pattern as chore-001 for consistency
  - yargs v18 used for modern ESM CLI parsing
---

## 2026-01-12 - feat-001
- Created packages/server/src/utils/git-validation.ts
- Implemented checkIsGitRepo using git rev-parse --git-dir
- Implemented checkIsCleanWorkingTree using git status --porcelain
- Exported validateGitRepository function combining both checks
- Returns GitValidationResult with valid boolean and errors array
- **Learnings:**
  - Used spawn from child_process directly for simpler git commands
  - Existing spawnProcess utility has logging that's not needed for validation
  - All functions accept optional cwd parameter for flexibility
---

## 2026-01-12 - feat-002
- Implemented main CLI entry point in packages/cli/src/cli.ts
- Added git validation before initialization
- Added DATABASE_URL env validation with helpful error
- Integrated tRPC handler and Ralph endpoint from server package
- Added static file serving from web-dist folder
- Added SPA fallback routing
- Added exports to @ralphban/server package.json for subpath imports
- **Learnings:**
  - Server package needed exports field to expose subpaths
  - Using .ts extensions in exports works with tsx for dev
  - web-dist path is relative to cli.ts location using __dirname
---

## 2026-01-12 - feat-003
- Implemented MCP CLI entry point in packages/mcp-cli/src/mcp-cli.ts
- Added yargs parsing for --cwd argument with demandOption
- Added absolute path validation for --cwd
- Added git validation on target directory
- Added DATABASE_URL env validation
- Changes process.cwd() to target directory before MCP init
- Initializes db pool and MCP server with stdio transport
- Added @modelcontextprotocol/sdk dependency to mcp-cli package
- Added ./mcp/server export to @ralphban/server package
- **Learnings:**
  - yargs hideBin helper strips node/tsx prefix from argv
  - MCP server creation reuses existing createMCPServer from server pkg
  - Server package exports need updating for each new subpath import
---

## 2026-01-12 - chore-003
- Added explicit build config to packages/web/vite.config.ts
- Set base: '/' for absolute asset paths (compatible with Express static)
- Set outDir: 'dist' and assetsDir: 'assets' explicitly
- Verified build outputs index.html and assets/index-*.js correctly
- **Learnings:**
  - Vite default base '/' produces absolute paths like /assets/index.js
  - Express.static serves these correctly when mounted at root
  - Explicit config documents intent even when matching defaults
---

## 2026-01-12 - chore-004
- Updated packages/server/src/ralph/service.ts MCP_CONFIG generation
- Changed from static const to buildMcpConfig function accepting workingDirectory
- Changed command from 'pnpm' to 'npx'
- Changed args from ['--filter', 'server', 'mcp:stdio'] to ['ralphban-mcp', '--cwd', workingDirectory]
- **Learnings:**
  - Integration test ralph-loop.test.ts times out because npx ralphban-mcp isn't published yet
  - Test designed for old pnpm workspace setup needs future update when packages are published
  - Linter auto-adds .js extension to imports for ESM compatibility
---

## 2026-01-12 - chore-005
- Updated @ralphban/api package.json with description, license, and repository fields
- Updated @ralphban/server package.json with description, license, and repository fields
- Verified builds complete successfully
- Verified npm pack --dry-run shows only dist files in tarball
- **Learnings:**
  - "files" field in package.json restricts what npm publish includes
  - Both packages already had private: false and exports configured correctly
---

## 2026-01-12 - chore-006
- Verified tsconfig already properly configured for both CLI packages (ES2022, ESNext module)
- Confirmed tsc preserves shebang lines in output
- Added chmod +x to build scripts in both packages/cli and packages/mcp-cli
- Tested direct execution of built CLIs successfully
- Verified imports to @ralphban/server subpaths resolve correctly
- **Learnings:**
  - TypeScript 5.9 preserves shebang comments automatically
  - moduleResolution: "bundler" works well for workspace dependencies
  - Build script can chain chmod with && for simple postbuild steps
---

## 2026-01-12 - chore-007
- Created .env.example files for packages/cli and packages/mcp-cli
- Added ANTHROPIC_API_KEY validation to both CLI entry points
- Added helpful error message with console.anthropic.com link
- dotenv/config already imported at top of both files from previous work
- **Learnings:**
  - ANTHROPIC_API_KEY used implicitly by spawned `claude` CLI in ralph service
  - Both CLIs already had DATABASE_URL validation with helpful messages
  - Integration test failure is pre-existing (npx ralphban-mcp not published)
---

## 2026-01-12 - chore-008
- Added build scripts to root package.json for all packages
- Added build:api, build:server, build:web, build:cli, build:mcp individual scripts
- Added build:all script that chains builds in correct dependency order (api → server → web → cli → mcp)
- Added CLI packages (ralphban, ralphban-mcp) to typecheck and lint commands
- **Learnings:**
  - Dependency order: api first (no deps), then server (needs api), then web/cli/mcp in parallel theoretically but sequential in build:all is safer
  - CLI packages use package name (ralphban, ralphban-mcp) not @ralphban/cli
  - Integration test still fails due to unpublished npx (pre-existing, chore-011 will fix)
---
