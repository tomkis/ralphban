## 2026-01-09 - CHORE-001
- Created `packages/server/src/ralph/` module
- Added `ralph.sh` script that takes working directory and prompt as args
- Script cd's to working dir before invoking claude
- Files changed: `packages/server/src/ralph/ralph.sh`
- **Learnings:**
  - Existing `plans/ralph.sh` reads prompt from file, new script takes it as argument
  - Script outputs claude result and checks for `<promise>COMPLETE</promise>` marker
---

## 2026-01-09 - CHORE-002
- Created ralph service for spawning and managing ralph.sh process
- Files changed: `packages/server/src/ralph/service.ts`
- **Learnings:**
  - Used ES module `import.meta.url` pattern with `fileURLToPath` to resolve `__dirname`
  - Service returns `RalphResult` with output, isComplete flag, and exitCode
  - AbortSignal support for external cancellation via SIGTERM
  - Process errors and non-zero exits are rejected, except when COMPLETE marker found
---

## 2026-01-09 - CHORE-003
- Created integration test for ralph loop
- Files changed: `packages/integration-tests/tests/ralph-loop.test.ts`, `packages/integration-tests/package.json`, `.gitignore`
- **Learnings:**
  - Test imports service from @ralphban/server workspace package
  - Test working dir `.ralph-test-workdir` is purged with `rm -rf` in beforeEach
  - 120s timeout required for claude CLI invocation
  - Test verifies both `isComplete` flag and actual file content
---

## 2026-01-09 - CHORE-004
- Created `packages/server/src/utils/process.ts` with generic `spawnProcess` function
- Refactored `packages/server/src/ralph/service.ts` to use the new util
- Files changed: `packages/server/src/utils/process.ts`, `packages/server/src/ralph/service.ts`
- **Learnings:**
  - Generic spawnProcess returns `SpawnResult` with stdout, stderr, exitCode
  - Supports callbacks for stdout/stderr streaming and AbortSignal for cancellation
  - Service now uses async/await instead of manual Promise construction
  - Error message translation needed (Process aborted -> Ralph loop aborted) for API consistency
---
